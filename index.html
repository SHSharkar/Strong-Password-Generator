<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Strong Password Generator</title>
    <meta name="description"
        content="Generate robust, random passwords to fortify your online security. Don't be a victim of cyber attacks." />
    <meta property="og:title" content="Strong Password Generator" />
    <meta property="og:description"
        content="Generate robust, random passwords to fortify your online security. Don't be a victim of cyber attacks." />
    <meta property="og:image" content="https://password.env.com.bd/sharing-image.jpg" />
    <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="android-icon-192x192.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
    <link rel="manifest" href="manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />
    <link href="dist/main.css" rel="stylesheet" />
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.4.2/zxcvbn.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Maven+Pro:wght@400..900&family=Source+Code+Pro:wght@500&display=swap"
        rel="stylesheet" />
</head>

<body class="p-6 font-sans">
    <div x-data="passwordGenerator()" x-init="generate()" class="mx-auto max-w-2xl">
        <a href="/">
            <h1 class="mb-4 text-xl font-semibold text-indigo-600 md:text-3xl">
                Strong Password Generator
            </h1>
        </a>
        <p class="mb-6 text-base font-medium text-gray-600 md:text-lg">
            Generate robust, random passwords to fortify your online security. Don't
            be a victim of cyber attacks.
        </p>
        <label for="length" class="block text-base font-medium text-gray-600">Password Length</label>
        <input x-model="length" @input="updateLength()" type="number" min="6" id="length" max="100"
            class="mt-1 block w-full rounded border-2 border-gray-300 bg-white px-3 py-2 text-base font-medium text-gray-700 shadow-sm focus:border-gray-400 focus:outline-none focus:ring-gray-400 md:text-lg" />
        <div class="mt-3 grid grid-cols-2 gap-3">
            <label>
                <input x-model="options.uppercase" @change="updateOptions('uppercase')" type="checkbox"
                    class="form-checkbox" />
                <span class="ml-2 text-lg">Include uppercase letters (A-Z)</span>
            </label>
            <label>
                <input x-model="options.lowercase" @change="updateOptions('lowercase')" type="checkbox"
                    class="form-checkbox" />
                <span class="ml-2 text-lg">Include lowercase letters (a-z)</span>
            </label>
            <label>
                <input x-model="options.numbers" @change="updateOptions('numbers')" type="checkbox"
                    class="form-checkbox" />
                <span class="ml-2 text-lg">Include numbers (0-9)</span>
            </label>
            <label>
                <input x-model="options.symbols" @change="updateOptions('symbols')" type="checkbox"
                    class="form-checkbox" />
                <span class="ml-2 text-lg">Include symbols (!@#$%^&*-_/=?+.)</span>
            </label>
        </div>
        <button @click="generate()"
            class="mt-3 w-full rounded border border-transparent bg-green-600 px-6 py-1 text-base font-semibold text-white shadow-sm hover:bg-green-700">
            Generate Password
        </button>
        <textarea
            @click="$clipboard(password).then(() => { copySuccess = true; setTimeout(() => { copySuccess = false }, 3000); }).catch(() => { copyFail = true; setTimeout(() => { copyFail = false }, 3000); })"
            x-ref="password" x-text="password" readonly
            class="source-code-pro mt-3 w-full rounded border-2 border-gray-300 bg-white px-3 py-2 text-lg font-medium text-gray-700 shadow-sm focus:border-gray-400 focus:outline-none focus:ring-gray-400 md:text-xl"></textarea>

        <button
            @click="$clipboard(password).then(() => { copySuccess = true; setTimeout(() => { copySuccess = false }, 3000); }).catch(() => { copyFail = true; setTimeout(() => { copyFail = false }, 3000); })"
            class="relative inline-flex items-center rounded border bg-indigo-500 px-3 py-1 text-sm font-semibold text-white hover:bg-indigo-600">
            Copy to Clipboard
        </button>
        <button @click="reset()"
            class="relative -ml-px inline-flex items-center rounded border bg-gray-300 px-3 py-1 text-sm font-semibold text-gray-700 hover:bg-gray-400">
            Reset to Default
        </button>

        <p x-cloak x-show="copySuccess" class="mt-3 text-base text-green-600">
            Copied to clipboard!
        </p>
        <p x-cloak x-show="copyFail" class="mt-3 text-base text-red-600">
            Failed to copy. Please manually select and copy.
        </p>

        <p x-show="message" x-text="message" class="mt-3 text-lg text-gray-600 font-semibold"></p>

        <div x-show="password" class="mt-4 md:mt-8">
            <h2 class="text-xl font-semibold text-gray-700">Evaluation</h2>
            <p class="mt-2 text-base text-gray-600">
                Your password's score:
                <span x-cloak :class="passwordScoreClass()" x-text="passwordScoreText()"></span>
            </p>
            <p class="mt-2 text-base text-gray-600">
                Time it would take for an attacker to crack this password:
                <span x-text="crackTime" class="font-semibold"></span>
            </p>
        </div>
    </div>

    <footer class="mt-6 text-center text-base font-semibold text-gray-700 md:mt-8">
        <p>
            &copy; {{current_year}}
            <a href="https://devops.com.bd" target="_blank" rel="noopener noreferrer" class="text-blue-600">DevOps</a>
            &
            <a href="https://github.com/SHSharkar" target="_blank" rel="noopener noreferrer" class="text-indigo-600">Md.
                Sazzad Hossain Sharkar</a>
        </p>
    </footer>

    <script>
        function passwordGenerator() {
            return {
                length: 18,
                password: "",
                score: 0,
                crackTime: "",
                copySuccess: false,
                copyFail: false,
                message: "",
                options: {
                    uppercase: true,
                    lowercase: true,
                    numbers: true,
                    symbols: true,
                },
                generate() {
                    const uppercaseCharacters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
                    const lowercaseCharacters = "abcdefghijklmnopqrstuvwxyz";
                    const numberCharacters = "0123456789";
                    const specialCharacters = "!@#$%^&*-_/=?+.";
                    let characters = "";

                    if (this.options.uppercase) characters += uppercaseCharacters;
                    if (this.options.lowercase) characters += lowercaseCharacters;
                    if (this.options.numbers) characters += numberCharacters;
                    if (this.options.symbols) characters += specialCharacters;

                    if (!characters.length) {
                        this.password = "";
                        return;
                    }

                    const result = [];

                    const totalTypes = Object.values(this.options).filter(Boolean).length;
                    let minCountPerType = Math.min(3, Math.floor(this.length / totalTypes));
                    minCountPerType = Math.max(1, minCountPerType);

                    let totalMinCharacters = 0;

                    if (this.options.uppercase) {
                        for (let i = 0; i < minCountPerType; i++) {
                            result.push(uppercaseCharacters.charAt(this.getRandomInt(uppercaseCharacters.length)));
                            totalMinCharacters++;
                        }
                    }

                    if (this.options.lowercase) {
                        for (let i = 0; i < minCountPerType; i++) {
                            result.push(lowercaseCharacters.charAt(this.getRandomInt(lowercaseCharacters.length)));
                            totalMinCharacters++;
                        }
                    }

                    if (this.options.numbers) {
                        for (let i = 0; i < minCountPerType; i++) {
                            result.push(numberCharacters.charAt(this.getRandomInt(numberCharacters.length)));
                            totalMinCharacters++;
                        }
                    }

                    if (this.options.symbols) {
                        for (let i = 0; i < minCountPerType; i++) {
                            result.push(specialCharacters.charAt(this.getRandomInt(specialCharacters.length)));
                            totalMinCharacters++;
                        }
                    }

                    for (let i = totalMinCharacters; i < this.length; i++) {
                        result.push(characters.charAt(this.getRandomInt(characters.length)));
                    }

                    this.shuffleArray(result);

                    const alphabetCharacters = uppercaseCharacters + lowercaseCharacters;
                    if (!alphabetCharacters.includes(result[0])) {
                        result[0] = alphabetCharacters.charAt(this.getRandomInt(alphabetCharacters.length));
                    }

                    if (!alphabetCharacters.includes(result[result.length - 1])) {
                        result[result.length - 1] = alphabetCharacters.charAt(this.getRandomInt(alphabetCharacters.length));
                    }

                    this.password = result.join('');

                    this.evaluate(this.password);

                    this.message = "Password generated successfully!";
                    setTimeout(() => {
                        this.message = "";
                    }, 3000);
                },
                getRandomInt(max) {
                    const array = new Uint32Array(1);
                    window.crypto.getRandomValues(array);
                    return array[0] % max;
                },
                shuffleArray(array) {
                    for (let i = array.length - 1; i > 0; i--) {
                        const j = this.getRandomInt(i + 1);
                        [array[i], array[j]] = [array[j], array[i]];
                    }
                },
                passwordScoreText() {
                    switch (this.score) {
                        case 0:
                            return "too guessable";
                        case 1:
                            return "very guessable";
                        case 2:
                            return "somewhat guessable";
                        case 3:
                            return "safely unguessable";
                        case 4:
                            return "very unguessable";
                        default:
                            return "";
                    }
                },
                passwordScoreClass() {
                    switch (this.score) {
                        case 0:
                            return "text-red-600";
                        case 1:
                            return "text-orange-600";
                        case 2:
                            return "text-yellow-600";
                        case 3:
                            return "text-green-600";
                        case 4:
                            return "text-blue-600";
                        default:
                            return "";
                    }
                },
                evaluate(password) {
                    const evaluation = zxcvbn(password);
                    this.score = evaluation.score;
                    this.crackTime =
                        evaluation.crack_times_display.offline_slow_hashing_1e4_per_second;
                },
                reset() {
                    this.length = 18;
                    this.options = {
                        uppercase: true,
                        lowercase: true,
                        numbers: true,
                        symbols: true,
                    };
                    this.generate();
                    this.message = "Reset to default settings.";
                    setTimeout(() => {
                        this.message = "";
                    }, 3000);
                },
                updateLength() {
                    this.generate();
                    this.message = `Password length updated to ${this.length}.`;
                    setTimeout(() => {
                        this.message = "";
                    }, 3000);
                },
                updateOptions(option) {
                    this.generate();
                    const status = this.options[option] ? 'enabled' : 'disabled';
                    const optionNames = {
                        uppercase: 'Uppercase letters',
                        lowercase: 'Lowercase letters',
                        numbers: 'Numbers',
                        symbols: 'Symbols',
                    };
                    this.message = `${optionNames[option]} ${status}.`;
                    setTimeout(() => {
                        this.message = "";
                    }, 3000);
                },
            };
        }

        document.addEventListener('alpine:init', () => {
            Alpine.magic('clipboard', () => subject => {
                return navigator.clipboard.writeText(subject);
            });
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const footer = document.querySelector("footer p");
            const year = new Date().getFullYear();
            footer.innerHTML = footer.innerHTML.replace("{{current_year}}", year);
        });
    </script>
</body>

</html>
